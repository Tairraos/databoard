import{I as ne}from"./document.69d75fce.js";import{I as se}from"./back.979bacf4.js";import{e as K,aj as U,aQ as H,b0 as Q,f as J,r as v,o as c,m as d,h as M,w as s,j as n,n as L,x as e,t as h,l as F,k as le,ai as ce,C as re,s as D,v as x,bH as ie,bI as ue,ao as de,a$ as u,P as E,Q as $,p as B,B as P,ak as _e,al as me,ap as ge,bJ as pe,V as ve,a7 as he,a8 as fe}from"./App.49df06d9.js";import{c as O}from"./config.3c16c364.js";import{I as be}from"./warning.68e51252.js";import{I as z}from"./plus.d9f5ee30.js";import{I as Ce}from"./edit.61b57b69.js";import{I as ke}from"./delete.d656b376.js";import{I as ye}from"./copy.b3b79b21.js";import{I as Ie}from"./show.9b4e227c.js";import{I as De}from"./hide.8ea76352.js";import{I as Ee}from"./drag.1323d952.js";import{c as Se}from"./index.10007f8d.js";const we=K({name:"SettingPanel",components:{IconBack:se,IconDocument:ne},setup(){const r=U(O),f=H();return{ComType:Q,com:r,back:()=>{f.selectSubCom("")}}}});const $e={class:"com-title-wp"},Be={class:"com-title"},Fe={class:"title-name"},Te={class:"alias-name"},Ae={class:"version-tag"};function xe(r,f,T,A,y,b){const I=v("IconBack"),C=v("n-icon"),m=v("IconDocument"),_=v("n-tooltip");return c(),d("div",$e,[r.com.type===r.ComType.subCom?(c(),M(C,{key:0,class:"back-icon",onClick:r.back},{default:s(()=>[n(I)]),_:1},8,["onClick"])):L("",!0),e("div",Be,[e("div",Fe,[e("span",Te,h(r.com.alias),1),n(_,{placement:"right"},{trigger:s(()=>[n(C,{class:"com-doc-icon"},{default:s(()=>[n(m)]),_:1})]),default:s(()=>[F(" "+h(`${r.com.name}\u6587\u6863`),1)]),_:1})]),e("div",Ae,[e("span",null,h(r.com.name),1)])]),le(r.$slots,"default",{},void 0,!0)])}const So=J(we,[["render",xe],["__scopeId","data-v-a77afdfa"]]),Pe=r=>(he("data-v-b4b2daa5"),r=r(),fe(),r),Me={key:0,class:"children-manager"},Ve={class:"children-manager-title"},Ne={class:"add-child-icon-wrapper",title:"\u6DFB\u52A0\u5B50\u7EC4\u4EF6"},je={class:"children-manager-selector"},ze={class:"children-manager-selector-component"},Ke=["onClick"],Ue=["src"],He={class:"children-manager-selector-option-name"},Qe={class:"children-manager-selector-info"},Je={class:"children-manager-selector-count"},Le={style:{color:"rgb(36 131 255)"}},Oe={class:"add-child"},We=Pe(()=>e("span",{class:"children-manager-name"},"\u5B50\u7EC4\u4EF6\u7BA1\u7406",-1)),qe=["onClick"],Ge={class:"children-manager-list"},Re={class:"children-list-container"},Xe=["onDragenter"],Ye={title:"\u66F4\u6539\u6807\u7B7E"},Ze={class:"children-manager-color-tag-wrapper"},eo={class:"children-manager-tag-panel"},oo=["onClick"],ao=["onUpdate:modelValue","onBlur","onKeydown"],to=["onClick"],no=["onClick"],so=["onClick"],lo=["onClick"],co=["onClick"],ro=["onDragstart"],io={key:1,class:"children-manager-child-not-exist"},uo=K({__name:"children-manager",setup(r){const f=["background: rgb(28, 31, 37); border-color: rgb(151, 151, 151);","background: rgb(0, 186, 255);","background: rgb(61, 231, 201);","background: rgb(255, 134, 55);","background: rgb(255, 59, 45);","background: rgb(178, 215, 127);","background: rgb(0, 127, 255);"],T=ce(),A=re(),y=U(O),b=H(),I=D(!1),C=D(!1),m=D(-1),_=D([]),g=D({from:"",to:"",toIdx:-1}),W=x(()=>ie.includes(y.value.name)),k=x(()=>{const o=b.subComs.filter(t=>t.parentId===y.value.id);return m.value>-1?m.value===0?o.filter(t=>!t.tag):o.filter(t=>t.tag===m.value):o}),q=x(()=>ue(y.value.name)),G=o=>{_.value.includes(o)?_.value=_.value.filter(t=>t!==o):_.value.push(o)},R=o=>{m.value=m.value===o?-1:o},X=async()=>{try{C.value=!0;const o=await Promise.all(_.value.map(t=>Se(t)));await pe(y.value,o),I.value=!1,_.value=[]}catch(o){A.error(o.message)}finally{C.value=!1}},Y=o=>{const t=T.create({content:`\u5220\u9664\u540E\u53EF\u80FD\u65E0\u6CD5\u6062\u590D\uFF0C\u662F\u5426\u5220\u9664${o.alias}`,negativeText:"\u53D6\u6D88",positiveText:"\u786E\u5B9A",iconPlacement:"top",icon:()=>ve(be),onPositiveClick:async()=>{t.loading=!0;try{await b.delete(o)}catch(l){A.error(l.message)}}})},Z=o=>{b.copy(o,Q.subCom)},ee=o=>{b.selectSubCom(o.id)},oe=(o,t)=>{g.value.from=t;const l=o.target.parentNode.parentNode;o.dataTransfer.setDragImage(l,308,15)},ae=()=>{const{from:o,to:t,toIdx:l}=g.value,S=l===k.value.length,w=S?k.value[l-1].id:t;b.sortSubCom(o,w,S),g.value={from:"",to:"",toIdx:-1}},V=(o,t)=>{g.value.to=o,g.value.toIdx=t},N=o=>{o.preventDefault(),o.stopPropagation(),o.dataTransfer.dropEffect="copy"};return(o,t)=>{const l=v("n-icon"),S=v("n-button"),w=v("n-popover"),te=de("focus");return u(W)?(c(),d("div",Me,[e("div",Ve,[e("div",null,[n(w,{show:I.value,"onUpdate:show":t[0]||(t[0]=a=>I.value=a),"show-arrow":!1,trigger:"click",placement:"left-start",raw:"",style:{"--n-space":"1px"}},{trigger:s(()=>[e("div",Ne,[n(l,{size:13},{default:s(()=>[n(u(z))]),_:1})])]),default:s(()=>[e("div",je,[e("div",ze,[(c(!0),d(E,null,$(u(q),a=>(c(),d("div",{key:a.name,class:B(["children-manager-selector-option",_.value.includes(a.name)?"selected":""]),onClick:p=>G(a.name)},[e("img",{src:a.img,class:"children-manager-selector-option-image"},null,8,Ue),e("span",He,h(a.alias),1)],10,Ke))),128))]),e("div",Qe,[e("div",Je,[F(" \u5DF2\u9009\u62E9 "),e("span",Le,h(_.value.length),1),F(" \u4E2A\u5B50\u7EC4\u4EF6 ")])]),e("div",Oe,[n(S,{size:"tiny",focusable:!1,disabled:_.value.length===0,loading:C.value,onClick:X},{icon:s(()=>[n(l,null,{default:s(()=>[n(u(z))]),_:1})]),default:s(()=>[F(" \u6DFB\u52A0\u5B50\u7EC4\u4EF6 ")]),_:1},8,["disabled","loading"])])])]),_:1},8,["show"]),We]),e("div",null,[(c(),d(E,null,$(f,(a,p)=>e("span",{key:p,class:B(["children-manager-color-tag-wrapper --anormal",{"--selected":m.value===p}]),onClick:i=>R(p)},[e("i",{class:"children-manager-color-tag",style:P(a)},null,4)],10,qe)),64))])]),e("div",Ge,[e("div",Re,[(c(!0),d(E,null,$(u(k),(a,p)=>(c(),d("div",{key:a.id,class:B(["children-item",{entering:g.value.toIdx===p}]),onDragenter:i=>V(a.id,p),onDragover:N},[e("div",null,[e("div",Ye,[n(w,{"show-arrow":!1,trigger:"click",placement:"bottom-start",raw:""},{trigger:s(()=>[e("span",Ze,[e("i",{class:"children-manager-color-tag",style:P(f[a.tag])},null,4)])]),default:s(()=>[e("div",eo,[(c(),d(E,null,$(f,(i,j)=>e("span",{key:j,class:"children-manager-color-tag-wrapper",onClick:_o=>a.tag=j},[e("i",{class:"children-manager-color-tag",style:P(i)},null,4)],8,oo)),64))])]),_:2},1024)]),a.renameing?_e((c(),d("input",{key:0,"onUpdate:modelValue":i=>a.alias=i,class:"com-alias-ipt",onBlur:i=>a.renameing=!1,onKeydown:ge(i=>a.renameing=!1,["enter"])},null,40,ao)),[[me,a.alias,void 0,{trim:!0}],[te]]):(c(),d(E,{key:1},[e("a",{draggable:"false",href:"javascript:;",class:"com-alias-text",onClick:i=>ee(a)},h(a.alias),9,to),e("div",{title:"\u70B9\u51FB\u9690\u85CF",onClick:i=>a.hided=!a.hided},[a.hided?(c(),M(l,{key:0,class:"child-status-btn"},{default:s(()=>[n(u(De))]),_:1})):(c(),M(l,{key:1,class:"child-status-btn"},{default:s(()=>[n(u(Ie))]),_:1}))],8,no)],64))]),e("div",null,[e("span",{title:"\u590D\u5236",class:"child-btn",onClick:i=>Z(a.id)},[n(l,null,{default:s(()=>[n(u(ye))]),_:1})],8,so),e("span",{title:"\u91CD\u547D\u540D",class:"child-btn",onClick:i=>a.renameing=!0},[n(l,null,{default:s(()=>[n(u(Ce))]),_:1})],8,lo),e("span",{title:"\u5220\u9664",class:"child-btn",onClick:i=>Y(a)},[n(l,null,{default:s(()=>[n(u(ke))]),_:1})],8,co),e("span",{title:"\u6392\u5E8F",class:"child-btn",draggable:"true",onDragstart:i=>oe(i,a.id),onDragend:ae},[n(l,null,{default:s(()=>[n(u(Ee))]),_:1})],40,ro)])],42,Xe))),128)),u(k).length>0?(c(),d("div",{key:0,class:B(["children-item last-placeholder",{entering:g.value.toIdx===u(k).length}]),onDragenter:t[1]||(t[1]=a=>V("",u(k).length)),onDragover:N},null,34)):(c(),d("div",io,h(m.value>-1?"\u8FC7\u6EE4\u7ED3\u679C\u4E3A\u7A7A":"\u5B50\u7EC4\u4EF6\u5217\u8868\u4E3A\u7A7A"),1))])])])):L("",!0)}}});const wo=J(uo,[["__scopeId","data-v-b4b2daa5"]]);export{So as C,wo as a};
