import{a4 as E,aA as z,a6 as m,aa as g,a7 as H,bh as N,ac as $,aX as C,ad as h,ae as F,af as I,ai as X,b4 as _,a5 as P,a9 as B,bi as j,b6 as L,aj as T,ah as D}from"./vendor.d49f6c0b.js";import{x as V,J as M,a as R,E as Y,w as G,H as Z,g as J,Z as S}from"./AppRoot.e99935fe.js";import{o as K,s as p}from"./dom.022ad87e.js";import{g as Q}from"./screen.87dff68d.js";const U=E({__name:"datav-item",props:{com:{type:Object,required:!0}},setup(o){const r=V(),l=z(()=>{const n=r.pageConfig.styleFilterParams;let u="";return n.enable&&(u=`hue-rotate(${n.hue}deg) contrast(${n.contrast}%) opacity(${n.opacity}%) saturate(${n.saturate}%) brightness(${n.brightness}%)`),u});return(n,u)=>(m(),g("div",{style:$({"pointer-events":"none","z-index":0,left:o.com.attr.x+"px",top:o.com.attr.y+"px",width:o.com.attr.w+"px",height:o.com.attr.h+"px",opacity:o.com.attr.opacity,transform:`rotate(${o.com.attr.deg}deg) ${o.com.attr.filpH?"scaleX(-1)":""} ${o.com.attr.filpV?"scaleY(-1)":""}`,filter:C(l)}),class:"-datav-com absolute"},[(m(),H(N(o.com.name),{com:o.com},null,8,["com"]))],4))}}),tt=E({__name:"datav-layer",props:{com:{type:Object,required:!0}},setup(o){const r=o,l=z(()=>{const{attr:e}=r.com;return{"pointer-events":"none",position:"absolute",overflow:"visible",width:`${e.w}px`,height:`${e.h}px`,opacity:e.opacity,transform:`translate(${e.x}px, ${e.y}px)`}}),n=z(()=>{const{attr:e}=r.com;return e.apply3d?{width:"100%",height:"100%",perspective:`${e.perspective}px`,"perspective-origin":`${e.perspectiveOrigin.x}% ${e.perspectiveOrigin.y}%`}:{width:"100%",height:"100%"}}),u=(e,s)=>{const c=(b,f)=>b===f?1:0;return`rotate3d(${c(e,"x")}, ${c(e,"y")}, ${c(e,"z")}, ${s}deg)`},v=e=>{const{attr:s}=e,c={justifyContent:"center",alignItems:"center",display:"block",opacity:1,transform:"translate3d(0, 0, 0)",width:"auto",height:"auto",position:"absolute",transformOrigin:`${s.w/2+s.x}px ${s.h/2+s.y}`};if(r.com.attr.apply3d){const b=r.com.config.find(O=>O.transform3d.id===e.id),{rotate3d:f,scale3d:k,translate3d:w}=b.transform3d;c.transform=`translate3d(${w.x}px, ${w.y}px, ${w.z}px) scale3d(${k.x}, ${k.y}, 1) ${u(f.axis,f.deg)}`}return c};return(e,s)=>(m(),g("div",{key:o.com.id,style:$(C(l)),class:"-datav-layer slider"},[h("div",{class:"slider-wrap",style:$(C(n))},[(m(!0),g(F,null,I(o.com.children,c=>(m(),g("div",{key:c.id,class:"slider-item",style:$(v(c))},[X(e.$slots,"default",{data:c})],4))),128))],4)],4))}}),et=E({name:"DatavTransform",props:{com:{type:Object,required:!0}},setup(){const o=r=>r.type===M.com?_(U,{com:r},{default:()=>_(P(r.name),{com:r})}):_(tt,{com:r},{default:({data:l})=>o(l)});return{create:o}},render(){return this.create(this.$props.com)}});const ot="//files.pengxiaotian.com",at=E({name:"Preview",components:{DatavCom:et},props:{screenId:{type:[String,Number],required:!0}},setup(o){const r=Y(),l=V(),n=G(),u=Z(),v=B(!0),{pageConfig:e}=j(l),{coms:s}=j(n),c=z(()=>{const t=e.value.styleFilterParams;let a="";return t.enable&&(a=`hue-rotate(${t.hue}deg) contrast(${t.contrast}%) opacity(${t.opacity}%) saturate(${t.saturate}%) brightness(${t.brightness}%)`),a}),b=(t,a)=>{const d=document.documentElement.clientWidth,x=document.documentElement.clientHeight,i=d/t,y=x/a;p(document.body,{transform:`scale(${i}, ${y})`,transformOrigin:"left top",backgroundSize:"100% 100%"})},f=t=>{const a=document.documentElement.clientWidth/t;p(document.body,{transform:`scale(${a})`,transformOrigin:"left top",backgroundSize:"100%"})},k=(t,a)=>{const d=document.documentElement.clientWidth,i=document.documentElement.clientHeight/a,y=(d-t*i)/2;p(document.body,{transform:`scale(${i})`,transformOrigin:"left top",backgroundSize:`${t/d*i*100}% 100%`,backgroundPosition:`${y.toFixed(3)}px top`,marginLeft:`${y.toFixed(3)}px`})},w=(t,a)=>{const d=document.documentElement.clientWidth,i=document.documentElement.clientHeight/a,y=(d-t*i)/2;p(document.body,{transform:`scale(${i})`,transformOrigin:"left top",backgroundSize:`${t/d*i*100}% 100%`,backgroundPosition:`${y.toFixed(3)}px top`}),document.documentElement.style.overflowX="scroll"},O=()=>{p(document.body,{overflow:"hidden",position:"relative"})},W=t=>{switch(t.zoomMode){case S.auto:b(t.width,t.height);break;case S.width:f(t.width);break;case S.height:k(t.width,t.height);break;case S.full:w(t.width,t.height);break;default:O();break}},q=t=>{document.title=l.screen.name,document.querySelector('meta[name="viewport"]').setAttribute("content",`width=${t.width}`),p(document.documentElement,{overflowX:"hidden",overflowY:"visible"}),p(document.body,{width:`${t.width}px`,height:`${t.height}px`,backgroundImage:`url(${e.value.bgimage})`,backgroundColor:e.value.bgcolor}),W(t)},A=L();return T(async()=>{var t;try{const a=await Q(+o.screenId);if(a){l.setEditorOption({screen:a.screen,config:a.config}),q(a.config),n.load(a.coms);const{componentsView:d,publishersView:x,subscribersView:i}=a.variables;u.$patch({componentsView:d,publishersView:x,subscribersView:i}),r.$patch({dataFilters:(t=a.dataFilters)!=null?t:[]}),setTimeout(()=>{v.value=!1},500),K(window,"resize",()=>{W(e.value)})}else throw new Error("404")}catch{A.replace({name:"NotFound",params:{catchAll:"error"}})}}),{cdn:ot,LOGO:J.logo,loading:v,pageConfig:e,coms:s,styleFilter:c}}}),rt={target:"_blank",href:"javascript:;"},nt=["src"],st={key:0,href:"/",target:"_blank",class:"datav-watermark"},ct=["src"],it={class:"scene"};function lt(o,r,l,n,u,v){const e=P("datav-com");return m(),g(F,null,[h("div",{id:"datav-loading",style:$({background:"rgb(15, 42, 66)",display:o.loading?"block":"none"})},[h("a",rt,[h("img",{class:"datav-logo",src:`${o.cdn}/datav/datav-loading.gif`},null,8,nt)])],4),h("div",{class:"datav-layout",style:$({visibility:o.loading?"hidden":"visible"})},[o.pageConfig.useWatermark?(m(),g("a",st,[h("img",{src:o.LOGO},null,8,ct)])):D("",!0),h("div",it,[(m(!0),g(F,null,I(o.coms,s=>(m(),H(e,{key:s.id,com:s},null,8,["com"]))),128))])],4)],64)}var ht=R(at,[["render",lt]]);export{ht as default};
