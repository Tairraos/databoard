import{e as _,aR as V,v as z,m as g,h as I,a_ as N,B as $,a$ as C,o as u,x as h,P as F,Q as j,k as A,b0 as L,V as E,r as q,aW as R,aQ as T,aY as X,s as Y,b1 as P,a4 as D,a0 as M,g as G,b2 as S,f as Q,n as Z}from"./App.49df06d9.js";import{o as J,s as p}from"./dom.20ecd84c.js";import{g as K}from"./screen.298e0da3.js";const U=_({__name:"datav-item",props:{com:{type:Object,required:!0}},setup(o){const n=V(),l=z(()=>{const a=n.pageConfig.styleFilterParams;let m="";return a.enable&&(m=`hue-rotate(${a.hue}deg) contrast(${a.contrast}%) opacity(${a.opacity}%) saturate(${a.saturate}%) brightness(${a.brightness}%)`),m});return(a,m)=>(u(),g("div",{style:$({"pointer-events":"none","z-index":0,left:o.com.attr.x+"px",top:o.com.attr.y+"px",width:o.com.attr.w+"px",height:o.com.attr.h+"px",opacity:o.com.attr.opacity,transform:`rotate(${o.com.attr.deg}deg) ${o.com.attr.filpH?"scaleX(-1)":""} ${o.com.attr.filpV?"scaleY(-1)":""}`,filter:C(l)}),class:"-datav-com absolute"},[(u(),I(N(o.com.name),{com:o.com,style:{"pointer-events":"auto"}},null,8,["com"]))],4))}}),tt=_({__name:"datav-layer",props:{com:{type:Object,required:!0}},setup(o){const n=o,l=z(()=>{const{attr:e}=n.com;return{"pointer-events":"none",position:"absolute",overflow:"visible",width:`${e.w}px`,height:`${e.h}px`,opacity:e.opacity,transform:`translate(${e.x}px, ${e.y}px)`}}),a=z(()=>{const{attr:e}=n.com;return e.apply3d?{width:"100%",height:"100%",perspective:`${e.perspective}px`,"perspective-origin":`${e.perspectiveOrigin.x}% ${e.perspectiveOrigin.y}%`}:{width:"100%",height:"100%"}}),m=(e,s)=>{const c=(b,f)=>b===f?1:0;return`rotate3d(${c(e,"x")}, ${c(e,"y")}, ${c(e,"z")}, ${s}deg)`},v=e=>{const{attr:s}=e,c={justifyContent:"center",alignItems:"center",display:"block",opacity:1,transform:"translate3d(0, 0, 0)",width:"auto",height:"auto",position:"absolute",transformOrigin:`${s.w/2+s.x}px ${s.h/2+s.y}`};if(n.com.attr.apply3d){const b=n.com.config.find(O=>O.transform3d.id===e.id),{rotate3d:f,scale3d:k,translate3d:w}=b.transform3d;c.transform=`translate3d(${w.x}px, ${w.y}px, ${w.z}px) scale3d(${k.x}, ${k.y}, 1) ${m(f.axis,f.deg)}`}return c};return(e,s)=>(u(),g("div",{key:o.com.id,style:$(C(l)),class:"-datav-layer slider"},[h("div",{class:"slider-wrap",style:$(C(a))},[(u(!0),g(F,null,j(o.com.children,c=>(u(),g("div",{key:c.id,class:"slider-item",style:$(v(c))},[A(e.$slots,"default",{data:c})],4))),128))],4)],4))}}),et=_({name:"DatavTransform",props:{com:{type:Object,required:!0}},setup(){const o=n=>n.type===L.com?E(U,{com:n},{default:()=>E(q(n.name),{com:n})}):E(tt,{com:n},{default:({data:l})=>o(l)});return{create:o}},render(){return this.create(this.$props.com)}}),ot="//files.pengxiaotian.com",rt=_({name:"Preview",components:{DatavCom:et},props:{screenId:{type:[String,Number],required:!0}},setup(o){const n=R(),l=V(),a=T(),m=X(),v=Y(!0),{pageConfig:e}=P(l),{coms:s}=P(a),c=z(()=>{const t=e.value.styleFilterParams;let r="";return t.enable&&(r=`hue-rotate(${t.hue}deg) contrast(${t.contrast}%) opacity(${t.opacity}%) saturate(${t.saturate}%) brightness(${t.brightness}%)`),r}),b=(t,r)=>{const d=document.documentElement.clientWidth,x=document.documentElement.clientHeight,i=d/t,y=x/r;p(document.body,{transform:`scale(${i}, ${y})`,transformOrigin:"left top",backgroundSize:"100% 100%"})},f=t=>{const r=document.documentElement.clientWidth/t;p(document.body,{transform:`scale(${r})`,transformOrigin:"left top",backgroundSize:"100%"})},k=(t,r)=>{const d=document.documentElement.clientWidth,i=document.documentElement.clientHeight/r,y=(d-t*i)/2;p(document.body,{transform:`scale(${i})`,transformOrigin:"left top",backgroundSize:`${t/d*i*100}% 100%`,backgroundPosition:`${y.toFixed(3)}px top`,marginLeft:`${y.toFixed(3)}px`})},w=(t,r)=>{const d=document.documentElement.clientWidth,i=document.documentElement.clientHeight/r,y=(d-t*i)/2;p(document.body,{transform:`scale(${i})`,transformOrigin:"left top",backgroundSize:`${t/d*i*100}% 100%`,backgroundPosition:`${y.toFixed(3)}px top`}),document.documentElement.style.overflowX="scroll"},O=()=>{p(document.body,{overflow:"hidden",position:"relative"})},W=t=>{switch(t.zoomMode){case S.auto:b(t.width,t.height);break;case S.width:f(t.width);break;case S.height:k(t.width,t.height);break;case S.full:w(t.width,t.height);break;default:O();break}},B=t=>{document.title=l.screen.name,document.querySelector('meta[name="viewport"]').setAttribute("content",`width=${t.width}`),p(document.documentElement,{overflowX:"hidden",overflowY:"visible"}),p(document.body,{width:`${t.width}px`,height:`${t.height}px`,backgroundImage:`url(${e.value.bgimage})`,backgroundColor:e.value.bgcolor}),W(t)},H=D();return M(async()=>{var t;try{const r=await K(+o.screenId);if(r){l.setEditorOption({screen:r.screen,config:r.config}),B(r.config),a.load(r.coms);const{componentsView:d,publishersView:x,subscribersView:i}=r.variables;m.$patch({componentsView:d,publishersView:x,subscribersView:i}),n.$patch({dataFilters:(t=r.dataFilters)!=null?t:[]}),setTimeout(()=>{v.value=!1},500),J(window,"resize",()=>{W(e.value)})}else throw new Error("404")}catch{H.replace({name:"NotFound",params:{catchAll:"error"}})}}),{cdn:ot,LOGO:G.logo,loading:v,pageConfig:e,coms:s,styleFilter:c}}});const nt={target:"_blank",href:"javascript:;"},at=["src"],st={key:0,href:"/",target:"_blank",class:"datav-watermark"},ct=["src"],it={class:"scene"};function lt(o,n,l,a,m,v){const e=q("datav-com");return u(),g(F,null,[h("div",{id:"datav-loading",style:$({background:"rgb(15, 42, 66)",display:o.loading?"block":"none"})},[h("a",nt,[h("img",{class:"datav-logo",src:`${o.cdn}/datav/datav-loading.gif`},null,8,at)])],4),h("div",{class:"datav-layout",style:$({visibility:o.loading?"hidden":"visible"})},[o.pageConfig.useWatermark?(u(),g("a",st,[h("img",{src:o.LOGO},null,8,ct)])):Z("",!0),h("div",it,[(u(!0),g(F,null,j(o.coms,s=>(u(),I(e,{key:s.id,com:s},null,8,["com"]))),128))])],4)],64)}const pt=Q(rt,[["render",lt]]);export{pt as default};
