import{v as K,I as U,a as q,a7 as ne,a8 as se,a9 as le}from"./App.404b9962.js";import{I as ce}from"./document.8fdddbc1.js";import{I as re}from"./back.2cb48cb6.js";import{c as H}from"./config.3c16c364.js";import{a4 as L,bm as O,a5 as v,a6 as c,aa as d,a7 as P,b1 as s,aV as n,ah as W,ad as e,ag as h,b8 as F,ai as ie,bl as ue,bb as de,a9 as D,al as x,bq as _e,am as u,ae as E,af as $,ab as B,ac as M,b4 as me,bn as ge,ak as pe,bj as ve,bk as he,bf as fe}from"./vendor.891943b7.js";import{I as be}from"./warning.078b14f6.js";import{I as z}from"./plus.e26fdb31.js";import{I as Ce}from"./edit.4ec2cf6b.js";import{I as ke}from"./delete.d67e866a.js";import{I as ye}from"./copy.93d9dd7e.js";import{I as Ie}from"./show.e61abf81.js";import{I as De}from"./hide.094467f4.js";import{I as Ee}from"./drag.9793705e.js";import{c as Se}from"./index.e63d2af6.js";const we=L({name:"SettingPanel",components:{IconBack:re,IconDocument:ce},setup(){const r=O(H),f=K();return{ComType:U,com:r,back:()=>{f.selectSubCom("")}}}}),$e={class:"com-title-wp"},Be={class:"com-title"},Fe={class:"title-name"},Te={class:"alias-name"},Ae={class:"version-tag"};function xe(r,f,T,A,y,b){const I=v("IconBack"),C=v("n-icon"),m=v("IconDocument"),_=v("n-tooltip");return c(),d("div",$e,[r.com.type===r.ComType.subCom?(c(),P(C,{key:0,class:"back-icon",onClick:r.back},{default:s(()=>[n(I)]),_:1},8,["onClick"])):W("",!0),e("div",Be,[e("div",Fe,[e("span",Te,h(r.com.alias),1),n(_,{placement:"right"},{trigger:s(()=>[n(C,{class:"com-doc-icon"},{default:s(()=>[n(m)]),_:1})]),default:s(()=>[F(" "+h(`${r.com.name}\u6587\u6863`),1)]),_:1})]),e("div",Ae,[e("span",null,h(r.com.name),1)])]),ie(r.$slots,"default",{},void 0,!0)])}var Fo=q(we,[["render",xe],["__scopeId","data-v-456507ad"]]);const Me=r=>(ve("data-v-786287d4"),r=r(),he(),r),Pe={key:0,class:"children-manager"},Ve={class:"children-manager-title"},Ne={class:"add-child-icon-wrapper",title:"\u6DFB\u52A0\u5B50\u7EC4\u4EF6"},je={class:"children-manager-selector"},ze={class:"children-manager-selector-component"},Ke=["onClick"],Ue=["src"],qe={class:"children-manager-selector-option-name"},He={class:"children-manager-selector-info"},Le={class:"children-manager-selector-count"},Oe=F(" \u5DF2\u9009\u62E9 "),We={style:{color:"rgb(36 131 255)"}},Ge=F(" \u4E2A\u5B50\u7EC4\u4EF6 "),Je={class:"add-child"},Qe=F(" \u6DFB\u52A0\u5B50\u7EC4\u4EF6 "),Re=Me(()=>e("span",{class:"children-manager-name"},"\u5B50\u7EC4\u4EF6\u7BA1\u7406",-1)),Xe=["onClick"],Ye={class:"children-manager-list"},Ze={class:"children-list-container"},eo=["onDragenter"],oo={title:"\u66F4\u6539\u6807\u7B7E"},ao={class:"children-manager-color-tag-wrapper"},to={class:"children-manager-tag-panel"},no=["onClick"],so=["onUpdate:modelValue","onBlur","onKeydown"],lo=["onClick"],co=["onClick"],ro=["onClick"],io=["onClick"],uo=["onClick"],_o=["onDragstart"],mo={key:1,class:"children-manager-child-not-exist"},go=L({__name:"children-manager",setup(r){const f=["background: rgb(28, 31, 37); border-color: rgb(151, 151, 151);","background: rgb(0, 186, 255);","background: rgb(61, 231, 201);","background: rgb(255, 134, 55);","background: rgb(255, 59, 45);","background: rgb(178, 215, 127);","background: rgb(0, 127, 255);"],T=ue(),A=de(),y=O(H),b=K(),I=D(!1),C=D(!1),m=D(-1),_=D([]),g=D({from:"",to:"",toIdx:-1}),G=x(()=>ne.includes(y.value.name)),k=x(()=>{const o=b.subComs.filter(t=>t.parentId===y.value.id);return m.value>-1?m.value===0?o.filter(t=>!t.tag):o.filter(t=>t.tag===m.value):o}),J=x(()=>se(y.value.name)),Q=o=>{_.value.includes(o)?_.value=_.value.filter(t=>t!==o):_.value.push(o)},R=o=>{m.value=m.value===o?-1:o},X=async()=>{try{C.value=!0;const o=await Promise.all(_.value.map(t=>Se(t)));await le(y.value,o),I.value=!1,_.value=[]}catch(o){A.error(o.message)}finally{C.value=!1}},Y=o=>{const t=T.create({content:`\u5220\u9664\u540E\u53EF\u80FD\u65E0\u6CD5\u6062\u590D\uFF0C\u662F\u5426\u5220\u9664${o.alias}`,negativeText:"\u53D6\u6D88",positiveText:"\u786E\u5B9A",iconPlacement:"top",icon:()=>fe(be),onPositiveClick:async()=>{t.loading=!0;try{await b.delete(o)}catch(l){A.error(l.message)}}})},Z=o=>{b.copy(o,U.subCom)},ee=o=>{b.selectSubCom(o.id)},oe=(o,t)=>{g.value.from=t;const l=o.target.parentNode.parentNode;o.dataTransfer.setDragImage(l,308,15)},ae=()=>{const{from:o,to:t,toIdx:l}=g.value,S=l===k.value.length,w=S?k.value[l-1].id:t;b.sortSubCom(o,w,S),g.value={from:"",to:"",toIdx:-1}},V=(o,t)=>{g.value.to=o,g.value.toIdx=t},N=o=>{o.preventDefault(),o.stopPropagation(),o.dataTransfer.dropEffect="copy"};return(o,t)=>{const l=v("n-icon"),S=v("n-button"),w=v("n-popover"),te=_e("focus");return u(G)?(c(),d("div",Pe,[e("div",Ve,[e("div",null,[n(w,{show:I.value,"onUpdate:show":t[0]||(t[0]=a=>I.value=a),"show-arrow":!1,trigger:"click",placement:"left-start",raw:"",style:{"--n-space":"1px"}},{trigger:s(()=>[e("div",Ne,[n(l,{size:13},{default:s(()=>[n(u(z))]),_:1})])]),default:s(()=>[e("div",je,[e("div",ze,[(c(!0),d(E,null,$(u(J),a=>(c(),d("div",{key:a.name,class:B(["children-manager-selector-option",_.value.includes(a.name)?"selected":""]),onClick:p=>Q(a.name)},[e("img",{src:a.img,class:"children-manager-selector-option-image"},null,8,Ue),e("span",qe,h(a.alias),1)],10,Ke))),128))]),e("div",He,[e("div",Le,[Oe,e("span",We,h(_.value.length),1),Ge])]),e("div",Je,[n(S,{size:"tiny",focusable:!1,disabled:_.value.length===0,loading:C.value,onClick:X},{icon:s(()=>[n(l,null,{default:s(()=>[n(u(z))]),_:1})]),default:s(()=>[Qe]),_:1},8,["disabled","loading"])])])]),_:1},8,["show"]),Re]),e("div",null,[(c(),d(E,null,$(f,(a,p)=>e("span",{key:p,class:B(["children-manager-color-tag-wrapper --anormal",{"--selected":m.value===p}]),onClick:i=>R(p)},[e("i",{class:"children-manager-color-tag",style:M(a)},null,4)],10,Xe)),64))])]),e("div",Ye,[e("div",Ze,[(c(!0),d(E,null,$(u(k),(a,p)=>(c(),d("div",{key:a.id,class:B(["children-item",{entering:g.value.toIdx===p}]),onDragenter:i=>V(a.id,p),onDragover:N},[e("div",null,[e("div",oo,[n(w,{"show-arrow":!1,trigger:"click",placement:"bottom-start",raw:""},{trigger:s(()=>[e("span",ao,[e("i",{class:"children-manager-color-tag",style:M(f[a.tag])},null,4)])]),default:s(()=>[e("div",to,[(c(),d(E,null,$(f,(i,j)=>e("span",{key:j,class:"children-manager-color-tag-wrapper",onClick:po=>a.tag=j},[e("i",{class:"children-manager-color-tag",style:M(i)},null,4)],8,no)),64))])]),_:2},1024)]),a.renameing?me((c(),d("input",{key:0,"onUpdate:modelValue":i=>a.alias=i,class:"com-alias-ipt",onBlur:i=>a.renameing=!1,onKeydown:pe(i=>a.renameing=!1,["enter"])},null,40,so)),[[ge,a.alias,void 0,{trim:!0}],[te]]):(c(),d(E,{key:1},[e("a",{draggable:"false",href:"javascript:;",class:"com-alias-text",onClick:i=>ee(a)},h(a.alias),9,lo),e("div",{title:"\u70B9\u51FB\u9690\u85CF",onClick:i=>a.hided=!a.hided},[a.hided?(c(),P(l,{key:0,class:"child-status-btn"},{default:s(()=>[n(u(De))]),_:1})):(c(),P(l,{key:1,class:"child-status-btn"},{default:s(()=>[n(u(Ie))]),_:1}))],8,co)],64))]),e("div",null,[e("span",{title:"\u590D\u5236",class:"child-btn",onClick:i=>Z(a.id)},[n(l,null,{default:s(()=>[n(u(ye))]),_:1})],8,ro),e("span",{title:"\u91CD\u547D\u540D",class:"child-btn",onClick:i=>a.renameing=!0},[n(l,null,{default:s(()=>[n(u(Ce))]),_:1})],8,io),e("span",{title:"\u5220\u9664",class:"child-btn",onClick:i=>Y(a)},[n(l,null,{default:s(()=>[n(u(ke))]),_:1})],8,uo),e("span",{title:"\u6392\u5E8F",class:"child-btn",draggable:"true",onDragstart:i=>oe(i,a.id),onDragend:ae},[n(l,null,{default:s(()=>[n(u(Ee))]),_:1})],40,_o)])],42,eo))),128)),u(k).length>0?(c(),d("div",{key:0,class:B(["children-item last-placeholder",{entering:g.value.toIdx===u(k).length}]),onDragenter:t[1]||(t[1]=a=>V("",u(k).length)),onDragover:N},null,34)):(c(),d("div",mo,h(m.value>-1?"\u8FC7\u6EE4\u7ED3\u679C\u4E3A\u7A7A":"\u5B50\u7EC4\u4EF6\u5217\u8868\u4E3A\u7A7A"),1))])])])):W("",!0)}}});var To=q(go,[["__scopeId","data-v-786287d4"]]);export{Fo as C,To as a};
