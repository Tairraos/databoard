import{a4 as O,bm as P,a9 as I,a5 as c,a6 as m,aa as _,ad as o,aV as l,b1 as h,ab as R,ag as B,b7 as T,ae as w,af as K,ah as U,b8 as $,al as q,bp as G,aD as H,aj as J,b4 as Q,b5 as W,a7 as V}from"./vendor.891943b7.js";import{a as M,F as X,aa as D}from"./App.404b9962.js";import{I as S}from"./arrow-right.a7b4c086.js";import{i as z,c as Y}from"./config.3c16c364.js";import{C as Z,a as N}from"./children-manager.9abd871a.js";import{E as x}from"./empty-panel.92461052.js";import{I as ee}from"./plus.e26fdb31.js";import{I as te}from"./delete.d67e866a.js";import"./document.8fdddbc1.js";import"./back.2cb48cb6.js";import"./warning.078b14f6.js";import"./edit.4ec2cf6b.js";import"./copy.93d9dd7e.js";import"./show.e61abf81.js";import"./hide.094467f4.js";import"./drag.9793705e.js";import"./index.e63d2af6.js";import"./templates.1d620fcb.js";const ne=O({name:"EventItem",components:{IconArrowRight:S,IconDelete:te,IconPlus:ee},props:{item:{type:Object,required:!0}},setup(t){const s=P(z),y=I(!0),C=I(t.item.enable);return{visible:y,isEnabled:C,addField:()=>{s.addField(t.item.name)},deleteField:u=>{s.deleteField(t.item.name,u)},updateField:(u,b,F)=>{u[b]=F;const k=t.item.fields.filter(v=>v.name).map(v=>({name:v.name,map:v.map}));s.updateField(t.item.name,k)},onEnableChange:u=>{t.item.enable=u,s.toggleEnable(t.item.name,u)}}}}),se={class:"event"},oe={class:"event-text"},ie=$(" \u542F\u7528 "),ae={key:0,class:"variables"},le={class:"variables-table"},de=o("thead",null,[o("tr",null,[o("th",{width:"80"},[o("span",null,"\u5B57\u6BB5")]),o("th",{width:"110",style:{position:"relative"}},[o("span",null,"\u7ED1\u5B9A\u5230\u53D8\u91CF")]),o("th",{width:"110"},[o("span",null,"\u5B57\u6BB5\u8BF4\u660E")])])],-1),ce={class:"variables-tbody"},ue={class:"variable-input"},re={class:"variable-input"},me={class:"variable-btn"},pe={class:"variable-input"},ve={class:"desc"},_e={class:"add-variable"},fe=$(" \u65B0\u5EFA\u4E00\u4E2A\u5B57\u6BB5 ");function be(t,s,y,C,E,a){const f=c("IconArrowRight"),p=c("n-icon"),u=c("n-checkbox"),b=c("new-input"),F=c("IconDelete"),k=c("IconPlus"),v=c("n-button");return m(),_("div",se,[o("div",{class:"events-title",onClick:s[2]||(s[2]=e=>t.visible=!t.visible)},[l(p,{class:R(t.visible?"events-down":"events-up")},{default:h(()=>[l(f)]),_:1},8,["class"]),o("div",oe,B(t.item.description),1),l(u,{checked:t.isEnabled,"onUpdate:checked":[s[0]||(s[0]=e=>t.isEnabled=e),t.onEnableChange],class:"enable-checkbox",onClick:s[1]||(s[1]=T(()=>{},["stop"]))},{default:h(()=>[ie]),_:1},8,["checked","onUpdate:checked"])]),t.visible?(m(),_("div",ae,[o("table",le,[de,o("tbody",ce,[(m(!0),_(w,null,K(t.item.fields,(e,i)=>(m(),_("tr",{key:i},[e.custom?(m(),_(w,{key:0},[o("td",ue,[l(b,{"model-value":e.name,placeholder:"\u53EF\u81EA\u5B9A\u4E49",class:"attr-input",onChange:n=>t.updateField(e,"name",n)},null,8,["model-value","onChange"])]),o("td",re,[l(b,{"model-value":e.map,placeholder:"\u53EF\u81EA\u5B9A\u4E49",class:"attr-input",onChange:n=>t.updateField(e,"map",n)},null,8,["model-value","onChange"])]),o("td",me,[l(p,{class:"delete-btn",onClick:n=>t.deleteField(i)},{default:h(()=>[l(F)]),_:2},1032,["onClick"])])],64)):(m(),_(w,{key:1},[o("td",null,B(e.name),1),o("td",pe,[l(b,{"model-value":e.map,placeholder:"\u53EF\u81EA\u5B9A\u4E49",class:"attr-input",onChange:n=>t.updateField(e,"map",n)},null,8,["model-value","onChange"])]),o("td",ve,B(e.description),1)],64))]))),128))])]),o("div",_e,[l(v,{focusable:!1,size:"tiny",onClick:t.addField},{icon:h(()=>[l(p,{size:12},{default:h(()=>[l(k)]),_:1})]),default:h(()=>[fe]),_:1},8,["onClick"])])])):U("",!0)])}var he=M(ne,[["render",be]]);const Ee=O({name:"InteractionPanel",components:{IconArrowRight:S,ConfigTitle:Z,EmptyPanel:x,EventItem:he,ChildrenManager:N},setup(){const t=X(),s=P(Y),y=I(!0),C=q(()=>Object.keys(s.value.events)),E=I([]);let a=I(t.componentsView[s.value.id]);const f=(e,i,n,r=!1)=>({name:e,map:i||e,description:n,custom:r}),p=e=>{if(a.value||(a.value={}),!a.value[e]){const i=Object.keys(s.value.events[e].fields);a.value[e]={enable:!1,fields:D(i)}}},u=()=>{const e=[];for(const[i,n]of Object.entries(s.value.events)){const r={name:i,description:n.description,enable:!1,fields:Object.entries(n.fields).map(([d,g])=>f(d,"",g.description))};if(a.value){const d=a.value[i];if(d){r.enable=d.enable;for(const[g,A]of Object.entries(d.fields)){const j=r.fields.find(L=>L.name===g);j?j.map=A:r.fields.push(f(g,A,"",!0))}}}e.push(r)}E.value.push(...e)};return G(z,{addField:e=>{const i=E.value.find(n=>n.name===e);i.fields.some(n=>n.name==="")||i.fields.push(f("","","",!0))},deleteField:(e,i)=>{const r=E.value.find(d=>d.name===e).fields.splice(i,1)[0].name;if(r){delete a.value[e].fields[r];const d=a.value[e];d.enable&&t.setPublishersView(s.value.id,Object.entries(d.fields).map(g=>g[1]||g[0]),!0)}},updateField:(e,i)=>{p(e),a.value[e].fields=D(i,"name","map"),a.value[e].enable&&t.setPublishersView(s.value.id,i.map(n=>n.map||n.name),!0)},toggleEnable:(e,i)=>{p(e);const n=a.value[e];n.enable=i;const r=[];for(const d in n.fields)i&&!n.fields[d]&&(n.fields[d]=d),r.push(n.fields[d]);t.setPublishersView(s.value.id,r,i)}}),H(a,()=>{t.componentsView[s.value.id]=a.value}),J(()=>{u()}),{com:s,eventKeys:C,visible:y,eventList:E}}}),ge={class:"interaction-panle"},Fe={key:0},ke={class:"com-events"},ye=o("span",null,B("\u4EA4\u4E92\u4E8B\u4EF6"),-1),Ce={class:"extra"},Ie=$("\u6559\u7A0B"),Be={class:"event-list"};function we(t,s,y,C,E,a){const f=c("config-title"),p=c("children-manager"),u=c("IconArrowRight"),b=c("n-icon"),F=c("router-link"),k=c("event-item"),v=c("empty-panel");return m(),_("div",ge,[l(f),l(p),t.eventKeys.length>0?(m(),_("div",Fe,[o("div",ke,[o("div",{class:"events-title",onClick:s[0]||(s[0]=e=>t.visible=!t.visible)},[l(b,{class:R(t.visible?"events-down":"events-up")},{default:h(()=>[l(u)]),_:1},8,["class"]),ye,o("span",Ce,[l(F,{to:{name:"MyCase"},target:"_blank",rel:"noopener noreferrer",class:"tutorial-link"},{default:h(()=>[Ie]),_:1})])]),Q(o("div",Be,[(m(!0),_(w,null,K(t.eventList,e=>(m(),V(k,{key:e.name,item:e},null,8,["item"]))),128))],512),[[W,t.visible]])])])):(m(),V(v,{key:1,content:"\u8BE5\u7EC4\u4EF6\u6CA1\u6709\u4EA4\u4E92\u4E8B\u4EF6"}))])}var Je=M(Ee,[["render",we]]);export{Je as default};
