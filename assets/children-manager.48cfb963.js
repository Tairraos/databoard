import{I as ne}from"./document.2929a580.js";import{I as se}from"./back.6a7d4f6b.js";import{e as z,aE as U,b8 as q,bj as L,r as O,aq as v,o as c,f as d,s as P,w as s,j as n,p as G,h as e,t as h,K as F,F as le,aD as ce,Y as re,I as D,x,c0 as ie,c1 as ue,aJ as de,k as u,L as E,O as $,q as B,n as M,aF as _e,aG as ge,aK as me,c2 as pe,a4 as ve,as as he,at as fe}from"./App.6555cd13.js";import{c as H}from"./config.3c16c364.js";import{I as Ce}from"./warning.088cc602.js";import{I as j}from"./plus.f2c510ea.js";import{I as be}from"./edit.0fe63215.js";import{I as ke}from"./delete.fc942bdb.js";import{I as ye}from"./copy.0eb06a46.js";import{I as Ie}from"./show.93abbf42.js";import{I as De}from"./hide.007fed57.js";import{I as Ee}from"./drag.396431dc.js";import{c as Se}from"./index.8fbef3df.js";const we=z({name:"SettingPanel",components:{IconBack:se,IconDocument:ne},setup(){const r=U(H),f=q();return{ComType:L,com:r,back:()=>{f.selectSubCom("")}}}});const $e={class:"com-title-wp"},Be={class:"com-title"},Fe={class:"title-name"},Te={class:"alias-name"},Ae={class:"version-tag"};function xe(r,f,T,A,y,C){const I=v("IconBack"),b=v("n-icon"),g=v("IconDocument"),_=v("n-tooltip");return c(),d("div",$e,[r.com.type===r.ComType.subCom?(c(),P(b,{key:0,class:"back-icon",onClick:r.back},{default:s(()=>[n(I)]),_:1},8,["onClick"])):G("",!0),e("div",Be,[e("div",Fe,[e("span",Te,h(r.com.alias),1),n(_,{placement:"right"},{trigger:s(()=>[n(b,{class:"com-doc-icon"},{default:s(()=>[n(g)]),_:1})]),default:s(()=>[F(" "+h(`${r.com.name}\u6587\u6863`),1)]),_:1})]),e("div",Ae,[e("span",null,h(r.com.name),1)])]),le(r.$slots,"default",{},void 0,!0)])}const So=O(we,[["render",xe],["__scopeId","data-v-a77afdfa"]]),Me=r=>(he("data-v-b4b2daa5"),r=r(),fe(),r),Pe={key:0,class:"children-manager"},Ke={class:"children-manager-title"},Ne={class:"add-child-icon-wrapper",title:"\u6DFB\u52A0\u5B50\u7EC4\u4EF6"},Ve={class:"children-manager-selector"},je={class:"children-manager-selector-component"},ze=["onClick"],Ue=["src"],qe={class:"children-manager-selector-option-name"},Le={class:"children-manager-selector-info"},Oe={class:"children-manager-selector-count"},Ge={style:{color:"rgb(36 131 255)"}},He={class:"add-child"},Je=Me(()=>e("span",{class:"children-manager-name"},"\u5B50\u7EC4\u4EF6\u7BA1\u7406",-1)),We=["onClick"],Ye={class:"children-manager-list"},Qe={class:"children-list-container"},Re=["onDragenter"],Xe={title:"\u66F4\u6539\u6807\u7B7E"},Ze={class:"children-manager-color-tag-wrapper"},eo={class:"children-manager-tag-panel"},oo=["onClick"],ao=["onUpdate:modelValue","onBlur","onKeydown"],to=["onClick"],no=["onClick"],so=["onClick"],lo=["onClick"],co=["onClick"],ro=["onDragstart"],io={key:1,class:"children-manager-child-not-exist"},uo=z({__name:"children-manager",setup(r){const f=["background: rgb(28, 31, 37); border-color: rgb(151, 151, 151);","background: rgb(0, 186, 255);","background: rgb(61, 231, 201);","background: rgb(255, 134, 55);","background: rgb(255, 59, 45);","background: rgb(178, 215, 127);","background: rgb(0, 127, 255);"],T=ce(),A=re(),y=U(H),C=q(),I=D(!1),b=D(!1),g=D(-1),_=D([]),m=D({from:"",to:"",toIdx:-1}),J=x(()=>ie.includes(y.value.name)),k=x(()=>{const o=C.subComs.filter(t=>t.parentId===y.value.id);return g.value>-1?g.value===0?o.filter(t=>!t.tag):o.filter(t=>t.tag===g.value):o}),W=x(()=>ue(y.value.name)),Y=o=>{_.value.includes(o)?_.value=_.value.filter(t=>t!==o):_.value.push(o)},Q=o=>{g.value=g.value===o?-1:o},R=async()=>{try{b.value=!0;const o=await Promise.all(_.value.map(t=>Se(t)));await pe(y.value,o),I.value=!1,_.value=[]}catch(o){A.error(o.message)}finally{b.value=!1}},X=o=>{const t=T.create({content:`\u5220\u9664\u540E\u53EF\u80FD\u65E0\u6CD5\u6062\u590D\uFF0C\u662F\u5426\u5220\u9664${o.alias}`,negativeText:"\u53D6\u6D88",positiveText:"\u786E\u5B9A",iconPlacement:"top",icon:()=>ve(Ce),onPositiveClick:async()=>{t.loading=!0;try{await C.delete(o)}catch(l){A.error(l.message)}}})},Z=o=>{C.copy(o,L.subCom)},ee=o=>{C.selectSubCom(o.id)},oe=(o,t)=>{m.value.from=t;const l=o.target.parentNode.parentNode;o.dataTransfer.setDragImage(l,308,15)},ae=()=>{const{from:o,to:t,toIdx:l}=m.value,S=l===k.value.length,w=S?k.value[l-1].id:t;C.sortSubCom(o,w,S),m.value={from:"",to:"",toIdx:-1}},K=(o,t)=>{m.value.to=o,m.value.toIdx=t},N=o=>{o.preventDefault(),o.stopPropagation(),o.dataTransfer.dropEffect="copy"};return(o,t)=>{const l=v("n-icon"),S=v("n-button"),w=v("n-popover"),te=de("focus");return u(J)?(c(),d("div",Pe,[e("div",Ke,[e("div",null,[n(w,{show:I.value,"onUpdate:show":t[0]||(t[0]=a=>I.value=a),"show-arrow":!1,trigger:"click",placement:"left-start",raw:"",style:{"--n-space":"1px"}},{trigger:s(()=>[e("div",Ne,[n(l,{size:13},{default:s(()=>[n(u(j))]),_:1})])]),default:s(()=>[e("div",Ve,[e("div",je,[(c(!0),d(E,null,$(u(W),a=>(c(),d("div",{key:a.name,class:B(["children-manager-selector-option",_.value.includes(a.name)?"selected":""]),onClick:p=>Y(a.name)},[e("img",{src:a.img,class:"children-manager-selector-option-image"},null,8,Ue),e("span",qe,h(a.alias),1)],10,ze))),128))]),e("div",Le,[e("div",Oe,[F(" \u5DF2\u9009\u62E9 "),e("span",Ge,h(_.value.length),1),F(" \u4E2A\u5B50\u7EC4\u4EF6 ")])]),e("div",He,[n(S,{size:"tiny",focusable:!1,disabled:_.value.length===0,loading:b.value,onClick:R},{icon:s(()=>[n(l,null,{default:s(()=>[n(u(j))]),_:1})]),default:s(()=>[F(" \u6DFB\u52A0\u5B50\u7EC4\u4EF6 ")]),_:1},8,["disabled","loading"])])])]),_:1},8,["show"]),Je]),e("div",null,[(c(),d(E,null,$(f,(a,p)=>e("span",{key:p,class:B(["children-manager-color-tag-wrapper --anormal",{"--selected":g.value===p}]),onClick:i=>Q(p)},[e("i",{class:"children-manager-color-tag",style:M(a)},null,4)],10,We)),64))])]),e("div",Ye,[e("div",Qe,[(c(!0),d(E,null,$(u(k),(a,p)=>(c(),d("div",{key:a.id,class:B(["children-item",{entering:m.value.toIdx===p}]),onDragenter:i=>K(a.id,p),onDragover:N},[e("div",null,[e("div",Xe,[n(w,{"show-arrow":!1,trigger:"click",placement:"bottom-start",raw:""},{trigger:s(()=>[e("span",Ze,[e("i",{class:"children-manager-color-tag",style:M(f[a.tag])},null,4)])]),default:s(()=>[e("div",eo,[(c(),d(E,null,$(f,(i,V)=>e("span",{key:V,class:"children-manager-color-tag-wrapper",onClick:_o=>a.tag=V},[e("i",{class:"children-manager-color-tag",style:M(i)},null,4)],8,oo)),64))])]),_:2},1024)]),a.renameing?_e((c(),d("input",{key:0,"onUpdate:modelValue":i=>a.alias=i,class:"com-alias-ipt",onBlur:i=>a.renameing=!1,onKeydown:me(i=>a.renameing=!1,["enter"])},null,40,ao)),[[ge,a.alias,void 0,{trim:!0}],[te]]):(c(),d(E,{key:1},[e("a",{draggable:"false",href:"javascript:;",class:"com-alias-text",onClick:i=>ee(a)},h(a.alias),9,to),e("div",{title:"\u70B9\u51FB\u9690\u85CF",onClick:i=>a.hided=!a.hided},[a.hided?(c(),P(l,{key:0,class:"child-status-btn"},{default:s(()=>[n(u(De))]),_:1})):(c(),P(l,{key:1,class:"child-status-btn"},{default:s(()=>[n(u(Ie))]),_:1}))],8,no)],64))]),e("div",null,[e("span",{title:"\u590D\u5236",class:"child-btn",onClick:i=>Z(a.id)},[n(l,null,{default:s(()=>[n(u(ye))]),_:1})],8,so),e("span",{title:"\u91CD\u547D\u540D",class:"child-btn",onClick:i=>a.renameing=!0},[n(l,null,{default:s(()=>[n(u(be))]),_:1})],8,lo),e("span",{title:"\u5220\u9664",class:"child-btn",onClick:i=>X(a)},[n(l,null,{default:s(()=>[n(u(ke))]),_:1})],8,co),e("span",{title:"\u6392\u5E8F",class:"child-btn",draggable:"true",onDragstart:i=>oe(i,a.id),onDragend:ae},[n(l,null,{default:s(()=>[n(u(Ee))]),_:1})],40,ro)])],42,Re))),128)),u(k).length>0?(c(),d("div",{key:0,class:B(["children-item last-placeholder",{entering:m.value.toIdx===u(k).length}]),onDragenter:t[1]||(t[1]=a=>K("",u(k).length)),onDragover:N},null,34)):(c(),d("div",io,h(g.value>-1?"\u8FC7\u6EE4\u7ED3\u679C\u4E3A\u7A7A":"\u5B50\u7EC4\u4EF6\u5217\u8868\u4E3A\u7A7A"),1))])])])):G("",!0)}}});const wo=O(uo,[["__scopeId","data-v-b4b2daa5"]]);export{So as C,wo as a};
